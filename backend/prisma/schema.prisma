generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
}

model User {
  id              Int               @id @default(autoincrement())
  uuid            String            @unique @default("")
  name            String
  email           String            @unique
  password        String
  phone           String
  address         String            @default("")
  nik             Int               @unique
  grade           String            @default("")
  profile_picture String            @default("")
  role            Role
  createdAt       DateTime          @default(now())
  updatedAt       DateTime          @updatedAt
  pembelianTikets Pembelian_tiket[]


  
  // kereta          Kereta[]       @relation("UserKereta")
  // reviews         Review[]
  // books           Book[]
  // notifications   Notification[]
}

model Kereta {
  id          Int       @id @default(autoincrement())
  uuid        String    @unique @default(uuid())
  name        String
  description String
  kelas       String
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  gerbong     Gerbong[]
  jadwal      Jadwal[]
}

model Gerbong {
  id       Int     @id @default(autoincrement())
  uuid     String  @unique @default(uuid())
  kouta    Int
  keretaId Int
  kereta   Kereta  @relation(fields: [keretaId], references: [id], onDelete: Cascade)
  kursi    Kursi[]
}

model Kursi {
  id               Int                @id @default(autoincrement())
  uuid             String             @unique @default(uuid())
  nomor            String
  gerbongId        Int
  gerbong          Gerbong            @relation(fields: [gerbongId], references: [id], onDelete: Cascade)
  detailPembelians Detail_pembelian[]
}

model Jadwal {
  id                    Int               @id @default(autoincrement())
  uuid                  String            @unique @default(uuid())
  asal_keberangkatan    String
  tujuan_keberangkatan  String
  tanggal_keberangkatan DateTime
  tanggal_kedatangan    DateTime
  harga                 Int
  keretaId              Int
  kereta                Kereta            @relation(fields: [keretaId], references: [id], onDelete: Cascade)
  pembelianTikets       Pembelian_tiket[]
}

model Pembelian_tiket {
  id                Int                @id @default(autoincrement())
  tanggal_pembelian DateTime           @default(now())
  userId            Int
  user              User               @relation(fields: [userId], references: [id])
  jadwalId          Int
  jadwal            Jadwal             @relation(fields: [jadwalId], references: [id])
  detail            Detail_pembelian[]
}

model Detail_pembelian {
  id             Int    @id @default(autoincrement())
  NIK            String
  nama_penumpang String
  id_pembelian_tiket Int
  pembelian          Pembelian_tiket @relation(fields: [id_pembelian_tiket], references: [id])
  id_kursi Int
  kursi    Kursi @relation(fields: [id_kursi], references: [id])
}






// model Kereta {
//   id          Int      @id @default(autoincrement())
//   uuid        String   @unique @default(uuid())
//   userId      Int
//   name        String
//   description String
//   user        User     @relation("UserKereta", fields: [userId], references: [id], onDelete: Cascade)
//   type        String
//   createdAt   DateTime @default(now())
//   updatedAt   DateTime @updatedAt
//   reviews     Review[]
//   books       Book[]
//   jadwals     Jadwal[]
// }

// model Jadwal {
//   id                 Int      @id @default(autoincrement())
//   uuid               String   @unique @default(uuid())
//   keretaId           Int
//   departure_location String
//   arrived_location   String
//   departure_time     DateTime
//   arrived_time       DateTime
//   price              Int
//   createdAt          DateTime @default(now())
//   updatedAt          DateTime @updatedAt
//   kereta             Kereta   @relation(fields: [keretaId], references: [id], onDelete: Cascade)
// }

// model Review {
//   id        Int      @id @default(autoincrement())
//   uuid      String   @unique @default(uuid())
//   keretaId  Int
//   userId    Int
//   comment   String
//   kereta    Kereta   @relation(fields: [keretaId], references: [id], onDelete: Cascade)
//   user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
//   createdAt DateTime @default(now())
//   updatedAt DateTime @updatedAt
// }

// model Book {
//   id        Int        @id @default(autoincrement())
//   uuid      String     @unique @default(uuid())
//   keretaId  Int
//   userId    Int
//   payment   Payment
//   status    BookStatus
//   createdAt DateTime   @default(now())
//   updatedAt DateTime   @updatedAt
//   kereta    Kereta     @relation(fields: [keretaId], references: [id], onDelete: Cascade)
//   user      User       @relation(fields: [userId], references: [id], onDelete: Cascade)
// }

// model Notification {
//   id        Int              @id @default(autoincrement())
//   uuid      String           @unique @default(uuid())
//   userId    Int
//   title     String
//   message   String
//   isRead    Boolean          @default(false)
//   relatedId Int?
//   createdAt DateTime         @default(now())
//   updatedAt DateTime         @updatedAt
//   user      User             @relation(fields: [userId], references: [id], onDelete: Cascade)
// }

enum Role {
  damin
  penumpang
}

// enum Kalender {
//   minggu
//   bulan
//   tahun
// }

// enum BookStatus {
//   pending
//   accept
//   reject
// }

// enum Payment {
//   cash
//   transfer
// }
